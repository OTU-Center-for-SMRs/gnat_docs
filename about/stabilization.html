<!DOCTYPE html><head><meta charset="UTF-8"><title>Stabilization for the Finite Element Method | Gnat</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Gnat</a><a href="https://github.com/OTU-Center-for-SMRs/gnat" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="cce30952-008c-4849-9f55-774c9c50ebc9" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="2dbb13b7-20ca-4821-977f-4102240c92e4" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e6095cea-335f-4a38-9a64-a15d3c7b0bc2" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#" class="sidenav-trigger" data-target="79d599cf-6ac7-4245-9905-a25081ece77b"><i class="material-icons">menu</i></a><ul class="sidenav" id="79d599cf-6ac7-4245-9905-a25081ece77b"><li><a href="#!" class="dropdown-trigger" data-target="d24e5373-ecc5-4d87-97d9-608f3a64f847" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="ab3d4ec8-de08-41bc-987c-89f0816452d0" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="a3bd31ac-dd9b-487f-af03-6dcb08bdc1a3" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="cce30952-008c-4849-9f55-774c9c50ebc9"><li><a href="../installation/index.html">Installation</a></li><li><a href="../tutorials/index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="2dbb13b7-20ca-4821-977f-4102240c92e4"><li><a href="radiation_transport.html">Radiation Transport</a></li><li><a href="mobile_depletion.html">Fluid Depletion</a></li><li><a href="implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="e6095cea-335f-4a38-9a64-a15d3c7b0bc2"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul><ul class="dropdown-content" id="d24e5373-ecc5-4d87-97d9-608f3a64f847"><li><a href="../installation/index.html">Installation</a></li><li><a href="../tutorials/index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="ab3d4ec8-de08-41bc-987c-89f0816452d0"><li><a href="radiation_transport.html">Radiation Transport</a></li><li><a href="mobile_depletion.html">Fluid Depletion</a></li><li><a href="implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="a3bd31ac-dd9b-487f-af03-6dcb08bdc1a3"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">about</span><a href="#" class="breadcrumb">stabilization</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="37fcfcd9-ccca-435c-ab8a-1edd5e817240" data-section-level="1" data-section-text="Stabilization for the Finite Element Method"><h1 id="stabilization-for-the-finite-element-method">Stabilization for the Finite Element Method</h1><p>Both the neutron transport equation and the mass transport equations are hyperbolic and are numerically unstable when solved using the finite element method. There are several approaches to mitigate the oscillations that occur in the neutron transport equation and mass transport problems dominated by streaming and advection (respectively). The following sections discuss the approaches taken by Gnat for both sets of governing equations, starting with the neutron transport equation and ending with the advection-diffusion equations.</p><section class="scrollspy" id="afc32316-15bb-4020-bfc3-320303ebf1ed" data-section-level="2" data-section-text="Neutron Transport"><h2 id="neutron-transport">Neutron Transport</h2><p>Gnat provides two stabilization schemes for the neutron transport equation, both being described below.</p><section id="2e1bec50-fbd6-4930-be71-da9bbfecc99a" data-section-level="3" data-section-text="1 . The Self - Adjoint Angular Flux Method"><h3 id="saaf">1. The Self-Adjoint Angular Flux Method</h3><p>The first approached implemented is the self-adjoint angular flux (SAAF) method derived by (TODO: REFERENCE HERE). We can write the transport equation where the collision term is on the left and all remaining terms are on the right:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-d9cb2fcd-f896-4238-afce-591dfcdaf874"></span><script>var element = document.getElementById("moose-equation-d9cb2fcd-f896-4238-afce-591dfcdaf874");katex.render("\\Sigma_{r,\\,g}\\Psi_{g} = \\sum_{g' = 1}^{G}\\int_{4\\pi}\\Sigma_{s,\\, g'\\rightarrow g}f_{g'\\rightarrow g}\\Psi_{g'}\\, d\\hat{\\Omega}' + S_{g} - \\frac{\\partial}{\\partial t}\\frac{\\Psi_{g}}{v_{g}} - \\hat{\\Omega}\\cdot\\vec{\\nabla}\\Psi_{g}", element, {displayMode:true,throwOnError:false});</script></span><p>Inverting the collision operator yields the following equation, which is known as the angular flux equation:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-4544425d-02d3-406b-8bdc-4ec9ab4215fb"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-4544425d-02d3-406b-8bdc-4ec9ab4215fb");katex.render("\\Psi_{g} = \\frac{1}{\\Sigma_{r,\\,g}} \\Big(\\sum_{g' = 1}^{G}\\int_{4\\pi}\\Sigma_{s,\\, g'\\rightarrow g}f_{g'\\rightarrow g}\\Psi_{g'}\\, d\\hat{\\Omega}' + S_{g} - \\frac{\\partial}{\\partial t}\\frac{\\Psi_{g}}{v_{g}} - \\hat{\\Omega}\\cdot\\vec{\\nabla}\\Psi_{g}\\Big)", element, {displayMode:true,throwOnError:false});</script></span><p><a class="moose-equation-reference" href="#moose-equation-4544425d-02d3-406b-8bdc-4ec9ab4215fb">Eq. (1)</a> can be substituted into <a class="moose-equation-reference" href="equations.html#moose-equation-2605728c-2b1f-4789-8ead-f46f446b3dcb">Governing Equations, Eq. (3)</a> and algebraically simplified to yield the SAAF weak form of the neutron transport equation:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-dab1de19-d04e-4e82-b6a3-0db749f6d69d"></span><span class="moose-katex-equation-number">(2)</span><script>var element = document.getElementById("moose-equation-dab1de19-d04e-4e82-b6a3-0db749f6d69d");katex.render("\\Big( \\psi_{j} + \\frac{1}{\\Sigma_{r,\\,g}}\\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\frac{\\partial}{\\partial t}\\frac{\\Psi^{h}_{g}}{v_{g}} \\Big)_{V} + \\Big\\langle \\psi_{j},\\, \\hat{n}\\cdot\\hat{\\Omega}\\Psi^{h}_{g} \\Big\\rangle_{\\Gamma} + \\Big( \\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\frac{1}{\\Sigma_{r,\\,g}}\\hat{\\Omega}\\cdot\\vec{\\nabla}\\Psi_{g}^{h}\\Big)_{V} + \\Big( \\psi_{j},\\, \\Sigma_{r,\\,g}\\Psi^{h}_{g} \\Big)_{V}\\\\ - \\Big( \\psi_{j} + \\frac{1}{\\Sigma_{r,\\,g}}\\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\sum_{g' 1}^{G}\\int_{4\\pi}\\Sigma_{s,\\, g'\\rightarrow g}f_{g'\\rightarrow g}\\Psi^{h}_{g'}\\, d\\Omega' \\Big)_{V} - \\Big( \\psi_{j} + \\frac{1}{\\Sigma_{r,\\,g}}\\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, S_{g} \\Big)_{V} = 0", element, {displayMode:true,throwOnError:false});</script></span><p><a class="moose-equation-reference" href="#moose-equation-dab1de19-d04e-4e82-b6a3-0db749f6d69d">Eq. (2)</a> is second order and therefore stable for continuous finite elements. However, the division by the removal cross-section makes <a class="moose-equation-reference" href="#moose-equation-dab1de19-d04e-4e82-b6a3-0db749f6d69d">Eq. (2)</a> ill-suited for regions where the removal cross-section is void or close to being a void. To remedy this an alternative form of the angular flux equation is proposed by (TODO: REFERENCE HERE):</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-740f8be6-cb00-4e15-9fcc-1641b4a6ebae"></span><span class="moose-katex-equation-number">(3)</span><script>var element = document.getElementById("moose-equation-740f8be6-cb00-4e15-9fcc-1641b4a6ebae");katex.render("\\Psi_{g} = \\Big(1 - \\tau_{g}\\Sigma_{r,\\, g}\\Big)\\Psi_{g} + \\tau_{g}\\Big(\\sum_{g' = 1}^{G}\\int_{4\\pi}\\Sigma_{s,\\, g'\\rightarrow g}f_{g'\\rightarrow g}\\Psi_{g'}\\, d\\Omega' + S_{g} - \\frac{\\partial}{\\partial t}\\frac{\\Psi_{g}}{v_{g}} - \\hat{\\Omega}\\cdot\\vec{\\nabla}\\Psi_{g}\\Big)", element, {displayMode:true,throwOnError:false});</script></span><p>where <span class="moose-katex-inline-equation" id="moose-equation-fd8b71da-86bc-46d7-a512-a1b6479bd5f8"><script>var element = document.getElementById("moose-equation-fd8b71da-86bc-46d7-a512-a1b6479bd5f8");katex.render("\\tau_{g}", element, {displayMode:false,throwOnError:false});</script></span> is defined as:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-ebfc34e2-c6a6-4990-a375-079d92f836f2"></span><span class="moose-katex-equation-number">(4)</span><script>var element = document.getElementById("moose-equation-ebfc34e2-c6a6-4990-a375-079d92f836f2");katex.render("\\tau_{g} = \\begin{cases} \\frac{1}{c\\Sigma_{r,\\,g}}, & ch\\Sigma_{r,\\,g} \\geq \\zeta\\\\ \\frac{h}{\\zeta}, & ch\\Sigma_{r,\\,g} < \\zeta \\end{cases}", element, {displayMode:true,throwOnError:false});</script></span><p>h is the maximum vertex separation within a single finite element, c and <span class="moose-katex-inline-equation" id="moose-equation-c1fb1381-562e-4672-8cfa-1ce73d179c0a"><script>var element = document.getElementById("moose-equation-c1fb1381-562e-4672-8cfa-1ce73d179c0a");katex.render("\\zeta", element, {displayMode:false,throwOnError:false});</script></span> are constants to determine the maximum stabilization in a void region. Selecting <span class="moose-katex-inline-equation" id="moose-equation-6e41711f-cb51-4d41-b025-6bee0e0e0eda"><script>var element = document.getElementById("moose-equation-6e41711f-cb51-4d41-b025-6bee0e0e0eda");katex.render("\\zeta = 0", element, {displayMode:false,throwOnError:false});</script></span> collapses <a class="moose-equation-reference" href="#moose-equation-740f8be6-cb00-4e15-9fcc-1641b4a6ebae">Eq. (3)</a> into <a class="moose-equation-reference" href="#moose-equation-4544425d-02d3-406b-8bdc-4ec9ab4215fb">Eq. (1)</a>. Substituting <a class="moose-equation-reference" href="#moose-equation-740f8be6-cb00-4e15-9fcc-1641b4a6ebae">Eq. (3)</a> into <a class="moose-equation-reference" href="equations.html#moose-equation-2605728c-2b1f-4789-8ead-f46f446b3dcb">Governing Equations, Eq. (3)</a> yields the void-treated SAAF weak form which is implemented in Gnat as the SAAF scheme:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-11d1eec2-4ea5-4cac-974b-2ab897c514de"></span><span class="moose-katex-equation-number">(5)</span><script>var element = document.getElementById("moose-equation-11d1eec2-4ea5-4cac-974b-2ab897c514de");katex.render("\\Big( \\psi_{j} + \\tau_{g}\\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\frac{\\partial}{\\partial t}\\frac{\\Psi^{h}_{g}}{v_{g}} \\Big)_{V} + \\Big\\langle \\psi_{j},\\, \\hat{n}\\cdot\\hat{\\Omega}\\Psi^{h}_{g} \\Big\\rangle_{\\Gamma} + \\Big( \\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\tau_{g}\\hat{\\Omega}\\cdot\\vec{\\nabla}\\Psi_{g}^{h} + (\\tau_{g}\\Sigma_{r,\\, g} - 1)\\Psi_{g}^{h} \\Big)_{V}\\\\ + \\Big( \\psi_{j},\\, \\Sigma_{r,\\,g}\\Psi^{h}_{g} \\Big)_{V} - \\Big( \\psi_{j} + \\tau_{g}\\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\sum_{g' = 1}^{G}\\int_{4\\pi}\\Sigma_{s,\\, g'\\rightarrow g}f_{g'\\rightarrow g}\\Psi^{h}_{g'}\\, d\\Omega' \\Big)_{V} - \\Big( \\psi_{j} + \\tau_{g}\\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, S_{g} \\Big)_{V} = 0", element, {displayMode:true,throwOnError:false});</script></span></section><section id="a79f4aab-fb03-4382-b722-860cbc0ecf04" data-section-level="3" data-section-text="2 . The Upwinding Method"><h3 id="upwind">2. The Upwinding Method</h3><p>The upwinding approach for the neutron transport equation follows from the discontinuous weak form of the neutron transport equation:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-c59466e7-085a-45d4-999c-f9bee6461bbe"></span><span class="moose-katex-equation-number">(6)</span><script>var element = document.getElementById("moose-equation-c59466e7-085a-45d4-999c-f9bee6461bbe");katex.render("\\Big( \\psi_{j},\\, \\frac{\\partial}{\\partial t}\\frac{\\Psi^{k}_{g}}{v_{g}} \\Big)_{D^{k}} + \\Big\\langle \\psi_{j},\\, \\hat{n}\\cdot\\hat{\\Omega}\\mathcal{F}^{*}_{g} \\Big\\rangle_{F^{k}} - \\Big( \\vec{\\nabla}\\psi_{j}\\cdot\\hat{\\Omega},\\, \\Psi^{k}_{g} \\Big)_{D^{k}}\\\\ + \\Big( \\psi_{j},\\, \\Sigma_{r,\\,g}\\Psi^{k}_{g} \\Big)_{D^{k}} - \\Big( \\psi_{j},\\, \\sum_{g' = 1}^{G}\\int_{4\\pi}\\Sigma_{s,\\, g'\\rightarrow g}f_{g'\\rightarrow g}\\Psi^{k}_{g'}\\,d\\Omega' \\Big)_{D^{k}} - \\Big( \\psi_{j},\\, S_{g} \\Big)_{D^{k}} = 0", element, {displayMode:true,throwOnError:false});</script></span><p>where:</p><ul class="browser-default"><li><p><span class="moose-katex-inline-equation" id="moose-equation-9758a5aa-2584-473b-aaa7-ca6206d4d926"><script>var element = document.getElementById("moose-equation-9758a5aa-2584-473b-aaa7-ca6206d4d926");katex.render("\\Psi^{k}_{g}", element, {displayMode:false,throwOnError:false});</script></span> are the trial functions defined on the single finite element <span class="moose-katex-inline-equation" id="moose-equation-ee755e7e-371a-4550-a95e-c573e8e0a27f"><script>var element = document.getElementById("moose-equation-ee755e7e-371a-4550-a95e-c573e8e0a27f");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span>. It is important to note that the trial functions are discontinuous over the full domain. </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-710cc924-bd7e-49e2-bf56-6a987df3e9c9"><script>var element = document.getElementById("moose-equation-710cc924-bd7e-49e2-bf56-6a987df3e9c9");katex.render("D^{k}", element, {displayMode:false,throwOnError:false});</script></span> is the volume of the finite element <span class="moose-katex-inline-equation" id="moose-equation-72c6bb02-1734-4338-aa00-66050034b210"><script>var element = document.getElementById("moose-equation-72c6bb02-1734-4338-aa00-66050034b210");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span> such that <span class="moose-katex-inline-equation" id="moose-equation-e7457ec3-4ee8-42bb-b6ef-352a66513e42"><script>var element = document.getElementById("moose-equation-e7457ec3-4ee8-42bb-b6ef-352a66513e42");katex.render("D^{k}\\in V", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-85e0c6e5-f50e-4c35-ba57-dcb942623811"><script>var element = document.getElementById("moose-equation-85e0c6e5-f50e-4c35-ba57-dcb942623811");katex.render("F^{k}", element, {displayMode:false,throwOnError:false});</script></span> is the bounding surface of the finite element <span class="moose-katex-inline-equation" id="moose-equation-12e4718e-d212-44ce-a5a9-899cb9d9e34f"><script>var element = document.getElementById("moose-equation-12e4718e-d212-44ce-a5a9-899cb9d9e34f");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-6aa047b7-f735-4d46-886d-052072cce3d2"><script>var element = document.getElementById("moose-equation-6aa047b7-f735-4d46-886d-052072cce3d2");katex.render("\\mathcal{F}^{*}_{g}(\\vec{r}) = \\Psi^{k}_{g}(\\vec{r}),\\, \\vec{r}\\in F^{k}", element, {displayMode:false,throwOnError:false});</script></span> is the interface numerical angular flux.</p></li></ul><p>The upwinding scheme is comparatively simple to the SAAF scheme. For each finite element <span class="moose-katex-inline-equation" id="moose-equation-3b5d59dd-5cae-4926-9c60-94148aa67082"><script>var element = document.getElementById("moose-equation-3b5d59dd-5cae-4926-9c60-94148aa67082");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span> the faces which compose the bounding surface <span class="moose-katex-inline-equation" id="moose-equation-047bdc57-8ec6-4d64-be8c-088d42279204"><script>var element = document.getElementById("moose-equation-047bdc57-8ec6-4d64-be8c-088d42279204");katex.render("F^{k}", element, {displayMode:false,throwOnError:false});</script></span> are traversed. Each face is classified as either upwind or downwind according to the following scheme:</p><ul class="browser-default"><li><p>Upwind faces are faces where <span class="moose-katex-inline-equation" id="moose-equation-3d75c74f-8e98-45ec-a2d1-6553958f5537"><script>var element = document.getElementById("moose-equation-3d75c74f-8e98-45ec-a2d1-6553958f5537");katex.render("\\hat{n}\\cdot\\hat{\\Omega} \\geq 0", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>Downwpwind faces are faces where <span class="moose-katex-inline-equation" id="moose-equation-27d29b34-97c6-4950-ae30-cc62434b2a89"><script>var element = document.getElementById("moose-equation-27d29b34-97c6-4950-ae30-cc62434b2a89");katex.render("\\hat{n}\\cdot\\hat{\\Omega} \\lt 0", element, {displayMode:false,throwOnError:false});</script></span>.</p></li></ul><p>The numerical flux is then equal to the value of the neighbour&#x27;s trial function at the interface for downwind faces, and the value of the current element&#x27;s trial function at the interface.</p></section></section><section class="scrollspy" id="4c32123a-50c3-4ca6-9f33-7c39203f22e4" data-section-level="2" data-section-text="Mass Transport"><h2 id="mass-transport">Mass Transport</h2><p>The stabilization approach taken for the isotope mass transport equation is the SUPG method (TODO: REFERENCE HERE). The SUPG method substitutes the set of continuous test functions for a discontinuous set of test functions which add artificial diffusion in the direction of advection. The derivation of the stabilized SUPG form begins with the discontinuous test functions:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-3996eb72-6ff5-4b4d-8d5c-a0bcb76fb7fd"></span><span class="moose-katex-equation-number">(7)</span><script>var element = document.getElementById("moose-equation-3996eb72-6ff5-4b4d-8d5c-a0bcb76fb7fd");katex.render("\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\, \\tau = \\frac{h}{2||v||}", element, {displayMode:true,throwOnError:false});</script></span><p>where <span class="moose-katex-inline-equation" id="moose-equation-cec3913d-6e0c-45f3-9133-c3f03176b567"><script>var element = document.getElementById("moose-equation-cec3913d-6e0c-45f3-9133-c3f03176b567");katex.render("\\vec{v}", element, {displayMode:false,throwOnError:false});</script></span> is the velocity and <span class="moose-katex-inline-equation" id="moose-equation-9cc43067-6907-4e73-a98a-421bab4cf71a"><script>var element = document.getElementById("moose-equation-9cc43067-6907-4e73-a98a-421bab4cf71a");katex.render("h", element, {displayMode:false,throwOnError:false});</script></span> is the minimum separation between vertices in a single finite element. Rearranging <a class="moose-equation-reference" href="equations.html#moose-equation-04409d2d-2062-4b16-8688-ebb105ddd6d8">Governing Equations, Eq. (6)</a> such that it equals zero, multiplying by the modified test functions <a class="moose-equation-reference" href="#moose-equation-3996eb72-6ff5-4b4d-8d5c-a0bcb76fb7fd">Eq. (7)</a> and integrating over the domain <span class="moose-katex-inline-equation" id="moose-equation-479b3c80-67cd-452d-be6d-ab5f3c8638fe"><script>var element = document.getElementById("moose-equation-479b3c80-67cd-452d-be6d-ab5f3c8638fe");katex.render("V", element, {displayMode:false,throwOnError:false});</script></span> yields the following:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-394da40b-3626-49d1-9c06-f3ea455ac1e8"></span><span class="moose-katex-equation-number">(8)</span><script>var element = document.getElementById("moose-equation-394da40b-3626-49d1-9c06-f3ea455ac1e8");katex.render("\\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\frac{\\partial}{\\partial t}N_{i}\\Big)_{V} + \\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\nabla\\cdot\\Big(\\vec{v}N_{i}\\Big)\\Big)_{V} + \\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\lambda_{i}N_{i}\\Big)_{V} + \\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\sum_{g = 1}^{G}\\sigma_{a,g,i}N_{i}\\Phi_{g}\\Big)_{V}\\\\ - \\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\nabla\\cdot\\Big(D_{i}\\vec{\\nabla}N_{i}\\Big)\\Big)_{V} - \\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\sum_{i' = 1}^{I}\\sum_{g = 1}^{G}\\sigma_{a,g,i'\\rightarrow i}N_{i'}\\Phi_{g}\\Big)_{V} - \\Big(\\psi_{j} + \\tau\\vec{v}\\cdot\\vec{\\nabla}\\psi_{j},\\,\\sum_{i' = 1}^{I}\\lambda_{i'}f_{i'\\rightarrow i}N_{i'}\\Big)_{V} = 0", element, {displayMode:true,throwOnError:false});</script></span><p>Applying integration by parts and the divergence theorem yields the final weak form for the isotope mass transport equation: </p></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#afc32316-15bb-4020-bfc3-320303ebf1ed" class="tooltipped" data-position="left" data-tooltip="Neutron Transport">Neutron Transport</a></li><li><a href="#4c32123a-50c3-4ca6-9f33-7c39203f22e4" class="tooltipped" data-position="left" data-tooltip="Mass Transport">Mass Transport</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script>